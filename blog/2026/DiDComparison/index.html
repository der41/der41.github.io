<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> DiD Is Not Just One Method — Why Staggered Programs Need a Better Yardstick | Diego E. Rodriguez </title> <meta name="author" content="Diego E. Rodriguez"> <meta name="description" content="In the world of data science, this " staggered rollout is a goldmine for research but it also trap. if we use old-school shortcuts to measure success often end up with the wrong answer.> <meta name="keywords" content="Data Science, AI, Machine Learning, Analytics"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/moai.png?db14a62c16a07eee1eaaf9b1798fe922"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://der41.github.io/blog/2026/DiDComparison/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "DiD Is Not Just One Method — Why Staggered Programs Need a Better Yardstick",
            "description": "In the world of data science, this "staggered rollout" is a goldmine for research, but it’s also a trap. If we use old-school shortcuts to measure success, we often end up with the wrong answer.",
            "published": "February 18, 2026",
            "authors": [
              
              {
                "author": "Diego Rodriguez",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "Duke University",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Diego</span> E. Rodriguez </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>DiD Is Not Just One Method — Why Staggered Programs Need a Better Yardstick</h1> <p>In the world of data science, this "staggered rollout" is a goldmine for research, but it’s also a trap. If we use old-school shortcuts to measure success, we often end up with the wrong answer.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#context">Context</a> </div> <div> <a href="#the-classic-did-a-simple-world">The Classic DiD - A Simple World</a> </div> <div> <a href="#the-tempting-shortcut-two-way-fixed-effects-twfe">The Tempting Shortcut - Two-Way Fixed Effects (TWFE)</a> </div> <div> <a href="#the-fix-the-sun-abraham-correction">The Fix - The Sun–Abraham Correction</a> </div> <div> <a href="#what-s-next">What’s next?</a> </div> </nav> </d-contents> <h2 id="context">Context</h2> <p>When a new policy like the <strong>Community Eligibility Program (CEP)</strong> rolls out, it doesn’t happen everywhere at once. Some schools sign up immediately, others wait a few years, and some may never join.</p> <p>In the world of data science, this “staggered rollout” is a goldmine for research, but it’s also a trap. If we use old-school shortcuts to measure success, we often end up with the wrong answer. This post explains why the “classic” way of measuring impact breaks down and how a newer method, the <em>Sun–Abraham correction</em>, gives us the truth.</p> <hr> <h2 id="the-classic-did---a-simple-world">The Classic DiD - A Simple World</h2> <p>The most common way to measure a policy’s impact is called Difference-in-Differences (DiD).Imagine two groups: a “Treated” group (schools that get CEP) and a “Control” group (schools that don’t). We look at the gap between them before the program and the gap after. If the gap grows, we attribute that change to the program.The standard regression version is:</p> \[Y_{it} = \alpha + \beta \cdot \text{Treated}_i + \gamma \cdot \text{Post}_t + \delta \cdot (\text{Treated}_i \times \text{Post}_t) + \varepsilon_{it}\] <ul> <li>\(Y_{it}\) is the outcome for school \(i\) in year \(t\)</li> <li>\(\delta\) is the DiD effect: the “change in the gap” or the causal effect</li> </ul> <p><strong>Classic DiD Implementation: 2 Groups and 2 Periods</strong></p> <div style="width: 70%; margin: 0 auto; text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Classic_DiD-480.webp 480w,/assets/img/Classic_DiD-800.webp 800w,/assets/img/Classic_DiD-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Classic_DiD.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption>Classic DiD Implementation: 2 Groups and 2 Periods</figcaption> </div> <p><strong>Why this isn’t enough for CEP:</strong></p> <p>Classic DiD assumes everyone is treated at the exact same time. But CEP is staggered. If you try to force a staggered rollout into this simple “before vs. after” box, you end up mixing schools that have had the program for five years with those that just started yesterday.</p> <hr> <h2 id="the-tempting-shortcut-two-way-fixed-effects-twfe">The Tempting Shortcut: Two-Way Fixed Effects (TWFE)</h2> <p>To handle different start dates, researchers often use a model called Two-Way Fixed Effects (TWFE). It’s designed to “control” for things that make schools different and for things that change over time (like a statewide policy change).</p> <p>The standard TWFE DiD regression is:</p> \[Y_{it} = \alpha_i + \lambda_t + \delta D_{it} + \varepsilon_{it}\] <ul> <li>\(\alpha_i\): school fixed effects</li> <li>\(\lambda_t\): year fixed effects</li> <li>\(D_{it}\): indicator that school $i$ participates in CEP in year \(t\)</li> <li>\(\delta\): interpreted as the “average treatment effect</li> </ul> <p><strong>Classic TWFE Implementation: Multiple cohorts staggered together</strong></p> <div style="width: 70%; margin: 0 auto; text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Classic_TWFE-480.webp 480w,/assets/img/Classic_TWFE-800.webp 800w,/assets/img/Classic_TWFE-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Classic_TWFE.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption>Classic TWFE Implementation: Multiple cohorts staggered together. This time we are looking at the effect before and after treatment (0) for all groups at the same time </figcaption> </div> <p>This time we are looking at the effect before and after treatment (0) for all groups at the same time.</p> <p><strong>”The “Forbidden Comparison” Problem:</strong> Here is where it gets messy. In a staggered rollout, the computer needs a “control group” for every school. Sometimes, it runs out of schools that haven’t been treated yet. When that happens, the model starts using early adopters (who already have the program) as the control group for late adopters.</p> <p><strong>The Problem:</strong> A school already receiving CEP isn’t a “clean” control. If the program’s impact grows over time—say, attendance improves more in year three than in year one—using an early adopter as a baseline will actually “contaminate” the results, making the program look less effective (or even harmful) than it actually is.</p> <hr> <h2 id="the-fix---the-sunabraham-correction">The Fix - The Sun–Abraham Correction</h2> <p>Economists Liyang Sun and Sarah Abraham proposed a clever fix: <strong>don’t mix the cohorts</strong>.Instead of throwing every school into one big pot, the Sun–Abraham method follows a “bottom-up” approach. It estimates effects separately by cohort and event time:</p> \[Y_{it} = \alpha_i + \lambda_t + \sum_{g}\sum_{k \neq -1} \beta_{gk} \mathbf{1}[G_i=g] \cdot \mathbf{1}[t-g=k] + \varepsilon_{it}\] <ul> <li>\(\beta_{gk}\) is the effect for cohort \(g\) at relative time \(k\)</li> <li>\(k=-1\) is typically omitted as the reference (“last pre-treatment year”)</li> </ul> <p>Sun-Abraham Implementation: Estimations by cohorts:</p> <div style="width: 70%; margin: 0 auto; text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Sun_Abraham_classic-480.webp 480w,/assets/img/Sun_Abraham_classic-800.webp 800w,/assets/img/Sun_Abraham_classic-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Sun_Abraham_classic.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption>. Early adopters are not consider for later adopters. They correspond to different cohorts </figcaption> </div> <p>Early adopters are not consider for later adopters. They correspond to different cohorts.</p> <p>Then, to report one overall event-study curve, Sun–Abraham aggregates these estimates:</p> \[\beta_k = \sum_g w_{gk}\beta_{gk} \quad \text{where} \quad \sum_g w_{gk}=1\] <p>This keeps comparisons clean by ensuring treated units aren’t serving as contaminated controls for later-treated units.</p> <hr> <h2 id="whats-next">What’s next?</h2> <p>Now that we have the right tools, it’s time to look at the data. In my next post, I will share the actual causal results of CEP adoption—stay tuned to see how free school meals impacted student outcomes.</p> <hr> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/false"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"der41/der41.github.io","data-repo-id":"R_kgDONUPMiQ","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Diego E. Rodriguez. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>